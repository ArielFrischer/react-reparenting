/**
* React-reparenting v0.3.0
* https://paol-imi.github.io/react-reparenting
* Copyright (c) 2020-present, Paol-imi
* Released under the MIT license
* https://github.com/Paol-imi/react-reparenting/blob/master/LICENSE
* @license MIT
*/
"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var n=e(require("@babel/runtime/helpers/classCallCheck")),t=e(require("@babel/runtime/helpers/assertThisInitialized")),r=e(require("@babel/runtime/helpers/inherits")),i=e(require("@babel/runtime/helpers/possibleConstructorReturn")),u=e(require("@babel/runtime/helpers/getPrototypeOf")),l=e(require("@babel/runtime/helpers/wrapNativeSuper")),o=e(require("@babel/runtime/helpers/defineProperty")),a=e(require("@babel/runtime/helpers/createClass")),s=e(require("@babel/runtime/helpers/typeof")),c=require("react");function f(e,n){var t=e.child;if(null===t)return null;if(-1===n)for(;t.sibling;)t=t.sibling;else for(;t.sibling&&n>0;)n-=1,t=t.sibling;return t}function p(e,n){var t=e.child;if(null===t)return null;if(t.key===n)return e;for(var r=t.sibling;r;){if(r.key===n)return t;r=(t=r).sibling}return null}function d(e,n){for(var t=e.sibling;t&&t.key!==n;)t=t.sibling;return t}function h(e,n,t){if(-1===t)return v(e,n);if(0===t)return m(e,n);var r=f(e,t-1);return null===r?m(e,n):y(r,n)}function b(e,n,t){var r=p(e,t);return null===r?v(e,n):r===e?m(e,n):y(r,n)}function v(e,n){var t=f(e,-1);return null===t?m(e,n):y(t,n)}function y(e,n){var t=e.sibling,r=e.index+1;return e.sibling=n,n.return=e.return,n.sibling=t,r}function m(e,n){var t=e.child;return e.child=n,n.sibling=t,n.return=e,0}function g(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,r=u(e);if(n){var l=u(this).constructor;t=Reflect.construct(r,arguments,l)}else t=r.apply(this,arguments);return i(this,t)}}var F=function(e){r(u,e);var i=g(u);function u(){var e;n(this,u);for(var r=arguments.length,l=new Array(r),a=0;a<r;a++)l[a]=arguments[a];return e=i.call.apply(i,[this].concat(l)),o(t(e),"name","Invariant"),e}return u}(l(Error));function C(e,n){if(!e)throw new F("Invariant failed")}function x(e,n){for(;e;)e.index=n,e=e.sibling,n+=1;return n-1}function R(e,n,t){var r;return x(n,r="number"==typeof t?h(e,n,t):b(e,n,t)),null===n.alternate||null===e.alternate?(null!==n.alternate&&(n.alternate.return=null,n.alternate.sibling=null),r):("number"==typeof t?h(e.alternate,n.alternate,t):b(e.alternate,n.alternate,t),x(n.alternate,r),r)}function k(e,n){if(C(n>=0),0===n)return w(e);var t=f(e,n-1);return null===t?null:D(t)}function N(e,n){var t=p(e,n);return null===t?null:t===e?w(e):D(t)}function w(e){var n=e.child;return null===n?null:(e.child=n.sibling,n)}function D(e){var n=e.sibling;return null===n?null:(e.sibling=n.sibling,n)}function I(e,n){var t=null;if(null===(t="number"==typeof n?k(e,n):N(e,n)))return null;if(null!==t.sibling&&x(t.sibling,t.index),null===t.alternate||null===e.alternate)return t;var r=null;return C(null!==(r="number"==typeof n?k(e.alternate,n):N(e.alternate,n))),null!==r.sibling&&x(r.sibling,r.index),t}var P={appendChildToContainer:function(e,n){e.appendChild(n)},insertInContainerBefore:function(e,n,t){e.insertBefore(n,t)},removeChildFromContainer:function(e,n){e.removeChild(n)},isElement:function(e,n){return n instanceof Element}};function q(e,n,t){for(;e;){if(t(e))return e;e=n(e)}return null}function E(e,n,t,r,i){var u=I(e,t);if(null===u)return-1;var l=R(n,u,r);if(i)return l;var o=q(e,(function(e){return e.return}),(function(e){return P.isElement(e.elementType,e.stateNode)})),a=q(n,(function(e){return e.return}),(function(e){return P.isElement(e.elementType,e.stateNode)}));if(null===o||null===a)return l;var s=q(u,(function(e){return e.child}),(function(e){return P.isElement(e.elementType,e.stateNode)}));if(null===s)return l;if(null===u.sibling)P.removeChildFromContainer(o.stateNode,s.stateNode),P.appendChildToContainer(a.stateNode,s.stateNode);else{var c=q(u.sibling,(function(e){return e.child}),(function(e){return P.isElement(e.elementType,e.stateNode)}));null!==c&&(P.removeChildFromContainer(o.stateNode,s.stateNode),P.insertInContainerBefore(a.stateNode,s.stateNode,c.stateNode))}return l}function _(e){if(null===e.alternate)return e;for(var n=e;null!==n.return;)n=n.return;return C(null!==n.stateNode&&"current"in n.stateNode),n.stateNode.current===n?e:e.alternate}function S(e){var n=Object.keys(e).find((function(e){return e.startsWith("__reactInternalInstance$")}));return C("string"==typeof n),e[n]}function M(e){return C("_reactInternalFiber"in e),e._reactInternalFiber}var T=function(){function e(){n(this,e),o(this,"fiber",null),o(this,"findFiber",void 0)}return a(e,[{key:"setFiber",value:function(e){this.fiber=e}},{key:"setFinder",value:function(e){this.findFiber=e}},{key:"getCurrent",value:function(){C(null!==this.fiber);var e=_(this.fiber);return"function"==typeof this.findFiber?this.findFiber(e):e}},{key:"addChild",value:function(e,n){return R(this.getCurrent(),e,n)}},{key:"removeChild",value:function(e){return I(this.getCurrent(),e)}},{key:"sendChild",value:function(e,n,t,r){return E(this.getCurrent(),e.getCurrent(),n,t,r)}},{key:"clear",value:function(){this.fiber=null}}]),e}();function j(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,r=u(e);if(n){var l=u(this).constructor;t=Reflect.construct(r,arguments,l)}else t=r.apply(this,arguments);return i(this,t)}}var A=function(e){r(u,e);var i=j(u);function u(){var e;n(this,u);for(var r=arguments.length,l=new Array(r),a=0;a<r;a++)l[a]=arguments[a];return e=i.call.apply(i,[this].concat(l)),o(t(e),"parent",new T),e}return a(u,[{key:"componentDidMount",value:function(){var e=this.props,n=e.parentRef,t=e.findFiber,r=M(this);C(null!==n&&("function"==typeof n||"object"===s(n))),this.parent.setFiber(r),this.parent.setFinder(t),"function"==typeof n&&n(this.parent),"object"===s(n)&&null!==n&&(n.current=this.parent)}},{key:"componentDidUpdate",value:function(){var e=this.props.findFiber;this.parent.setFinder(e)}},{key:"componentWillUnmount",value:function(){this.parent.clear()}},{key:"render",value:function(){return this.props.children}}]),u}(c.Component);function O(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,r=u(e);if(n){var l=u(this).constructor;t=Reflect.construct(r,arguments,l)}else t=r.apply(this,arguments);return i(this,t)}}var U=new Map;var W=function(e){r(u,e);var i=O(u);function u(){var e;n(this,u);for(var r=arguments.length,l=new Array(r),a=0;a<r;a++)l[a]=arguments[a];return e=i.call.apply(i,[this].concat(l)),o(t(e),"parent",new T),e}return a(u,[{key:"componentDidMount",value:function(){var e=this.props,n=e.id,t=e.findFiber,r=M(this);C("string"==typeof n),this.parent.setFiber(r),this.parent.setFinder(t),U.set(n,this.parent)}},{key:"componentDidUpdate",value:function(){var e=this.props.findFiber;this.parent.setFinder(e)}},{key:"componentWillUnmount",value:function(){var e=this.props.id;U.delete(e),this.parent.clear()}},{key:"render",value:function(){return this.props.children}}]),u}(c.Component);exports.Env=P,exports.Parent=A,exports.ParentFiber=T,exports.Reparentable=W,exports.ReparentableMap=U,exports.addChild=R,exports.addChildFiberAt=h,exports.addChildFiberBefore=b,exports.addSiblingFiber=y,exports.appendChildFiber=v,exports.configure=function(e){Object.assign(P,e)},exports.createParent=function(e,n){var t=new T,r=e.componentDidMount,i=e.componentWillUnmount;return e.componentDidMount=function(){var i=M(e);t.setFiber(i),t.setFinder(n),"function"==typeof r&&r.call(this)},e.componentWillUnmount=function(){"function"==typeof i&&i.call(this),t.clear()},t},exports.findChildFiber=function(e,n){var t=e.child;return null===t?null:t.key===n?t:d(t,n)},exports.findChildFiberAt=f,exports.findPreviousFiber=p,exports.findSiblingFiber=d,exports.getCurrentFiber=_,exports.getFiberFromClassInstance=M,exports.getFiberFromElementInstance=S,exports.prependChildFiber=m,exports.removeChild=I,exports.removeChildFiber=N,exports.removeChildFiberAt=k,exports.removeFirstChildFiber=w,exports.removeSiblingFiber=D,exports.searchFiber=q,exports.sendChild=E,exports.sendReparentableChild=function(e,n,t,r,i){var u=U.get(e),l=U.get(n);return void 0===u||void 0===l?-1:u.sendChild(l,t,r,i)},exports.updateFiberDebugFields=function(e,n){var t;C(null!==n.child),t=n.child===e?null===e.sibling?n:e.sibling:n.child,e._debugOwner=t._debugOwner,e._debugSource=t._debugSource},exports.updateFibersIndices=x,exports.useParent=function(e){var n=c.useRef(null),t=c.useRef(null);null===n.current&&(n.current=new T);var r=n.current;return r.setFinder(e),c.useEffect((function(){return C(null!==t.current),r.setFiber(S(t.current)),function(){r.clear()}}),[]),[r,t]};
