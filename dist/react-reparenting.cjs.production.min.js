/**
* React-reparenting v0.1.0
* https://github.com/Paol-imi/react-reparenting#readme
* Copyright (c) 2020-present, Paol-imi
* Released under the MIT license
* https://github.com/Paol-imi/react-reparenting/blob/master/LICENSE
* @license MIT
*/
"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("@babel/runtime/helpers/classCallCheck")),n=e(require("@babel/runtime/helpers/createClass")),r=e(require("@babel/runtime/helpers/defineProperty")),i=e(require("@babel/runtime/helpers/typeof")),u=e(require("@babel/runtime/helpers/assertThisInitialized")),l=e(require("@babel/runtime/helpers/inherits")),o=e(require("@babel/runtime/helpers/possibleConstructorReturn")),a=e(require("@babel/runtime/helpers/getPrototypeOf")),c=e(require("@babel/runtime/helpers/wrapNativeSuper")),s=require("react"),f=e(s),p=e(require("@babel/runtime/helpers/get")),h=e(require("@babel/runtime/helpers/slicedToArray")),b={appendChildToContainer:function(e,t){e.appendChild(t)},insertInContainerBefore:function(e,t,n){e.insertBefore(t,n)},removeChildFromContainer:function(e,t){e.removeChild(t)},isElement:function(e,t){return t instanceof Element}};function d(e,t){var n=e.child;if(null===n)return null;if(-1===t)for(;n.sibling;)n=n.sibling;else for(;n&&t-- >0;)n=n.sibling;return n}function v(e,t){var n,r=e.child;if(null===r)return null;if(r.key===t)return e;for(;r;){if((n=r.sibling)&&n.key===t)return r;r=n}return r}function y(e,t){for(;e;){if(t(e.elementType,e.stateNode))return e;e=e.return}return null}function m(e,t){for(;e;){if(t(e.elementType,e.stateNode))return e;e=e.child}return null}function g(e,t){for(;e;)e.index=t,e=e.sibling,t+=1}function x(e,t){if(null!==t)if(t.child===e){var n=e.sibling;null!==n&&(e._debugOwner=n._debugOwner)}else e._debugOwner=t.child&&t.child._debugOwner}function F(e,t,n,r){if(-1===n)return R(e,t,r);if(0===n)return w(e,t,r);var i=d(e,n-1);return null===i?R(e,t,r):k(i,t,r)}function C(e,t,n,r){var i=v(e,n);return null===i?R(e,t,r):i===e?w(e,t,r):k(i,t,r)}function R(e,t,n){var r=d(e,-1);return null===r?w(e,t,n):k(r,t,n)}function k(e,t,n){var r=e.sibling,i=e.index+1;return e.sibling=t,t.sibling=r,t.return=e.return,n||(g(t,i),x(t,e.return)),i}function w(e,t,n){var r=e.child;return e.child=t,t.sibling=r,t.return=e,n||(g(t,0),x(t,e)),0}function I(e,t,n){if(t<0)return null;if(0===t)return q(e,n);var r=d(e,t-1);return null===r?null:N(r,n)}function P(e,t,n){var r=v(e,t);return null===r?null:r===e?q(e,n):N(r,n)}function N(e,t){var n=e.sibling;return null===n?null:(e.sibling=n.sibling,n.return=null,n.sibling=null,t||g(e,e.index),n)}function q(e,t){var n=e.child;return null===n?null:(e.child=n.sibling,n.return=null,n.sibling=null,t||g(e.child,0),n)}function D(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var E=function(e){l(c,e);var n,i=(n=c,function(){var e,t=a(n);if(D()){var r=a(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return o(this,e)});function c(){var e;t(this,c);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return e=i.call.apply(i,[this].concat(l)),r(u(e),"name","Invariant"),e}return c}(c(Error));function _(e,t){if(!e)throw new E("Invariant failed")}function A(e){if(!e.alternate)return e;for(var t=e;t.return;)t=t.return;return t.stateNode.current===t?e:e.alternate}function M(e){var t=Object.keys(e).find((function(e){return e.startsWith("__reactInternalInstance$")}));return _("string"==typeof t),e[t]}function O(e){return _("object"===i(e)&&"_reactInternalFiber"in e),e._reactInternalFiber}var j=function(){function e(n){t(this,e),r(this,"fiber",null),n&&this.setFiber(n)}return n(e,[{key:"setFiber",value:function(e){this.fiber=e}},{key:"getFiber",value:function(){return _(null!==this.fiber),A(this.fiber)}},{key:"add",value:function(e,t){var n,r=this.getFiber();return n="number"==typeof t?F(r,e,t):C(r,e,t),null===e.alternate||null===r.alternate?(e.alternate=null,n):("number"==typeof t?F(r.alternate,e.alternate,t):C(r.alternate,e.alternate,t),n)}},{key:"remove",value:function(e){var t=this.getFiber(),n=null;return null===(n="number"==typeof e?I(t,e):P(t,e))?null:(null===n.alternate||null===t.alternate||("number"==typeof e?I(t.alternate,e):P(t.alternate,e)),n)}},{key:"send",value:function(e,t,n,r){var i=this.remove(e);if(null===i)return-1;var u=t.add(i,n);if(!r){var l=y(this.fiber,b.isElement),o=y(t.fiber,b.isElement);if(null===l||null===o)return u;var a=m(i,b.isElement),c=m(i.sibling,b.isElement);if(null===a||null!==i.sibling&&null===c)return u;b.removeChildFromContainer(l.stateNode,a.stateNode),null===c?b.appendChildToContainer(o.stateNode,a.stateNode):b.insertInContainerBefore(o.stateNode,a.stateNode,c.stateNode)}return u}},{key:"clear",value:function(){this.fiber=null}}]),e}();function S(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var T=function(e){l(f,e);var c,s=(c=f,function(){var e,t=a(c);if(S()){var n=a(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return o(this,e)});function f(){var e;t(this,f);for(var n=arguments.length,i=new Array(n),l=0;l<n;l++)i[l]=arguments[l];return e=s.call.apply(s,[this].concat(i)),r(u(e),"parent",new j),e}return n(f,[{key:"componentDidMount",value:function(){var e=this.props,t=e.parentRef,n=e.findFiber,r=O(this);_(t&&("function"==typeof t||"object"===i(t))),"function"==typeof n?this.parent.setFiber(n(r)):this.parent.setFiber(r),"function"==typeof t&&t(this.parent),"object"===i(t)&&(t.current=this.parent)}},{key:"componentWillUnmount",value:function(){this.parent.clear()}},{key:"render",value:function(){return this.props.children}}]),f}(s.Component);function W(e){return function(){var t,n=a(e);if(B()){var r=a(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return o(this,t)}}function B(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var U=s.createContext(null);U.displayName="Reparentable";var z=function(e){l(i,e);var n=W(i);function i(){var e;t(this,i);for(var l=arguments.length,o=new Array(l),c=0;c<l;c++)o[c]=arguments[c];return e=n.call.apply(n,[this].concat(o)),r(u(e),"set",(function(t,n){return p(a(i.prototype),"set",u(e)).call(u(e),t,n)})),r(u(e),"send",(function(t,n,r,i,u){var l=e.get(t),o=e.get(n);return void 0===l||void 0===o?-1:l.send(r,o,i,u)})),r(u(e),"remove",(function(t){return e.delete(t)})),e}return i}(c(Map)),V=function(e){l(a,e);var o=W(a);function a(){var e;t(this,a);for(var n=arguments.length,i=new Array(n),l=0;l<n;l++)i[l]=arguments[l];return e=o.call.apply(o,[this].concat(i)),r(u(e),"map",new z),e}return n(a,[{key:"componentDidMount",value:function(){var e=this.props.reparentableMapRef;null!==e&&("function"==typeof e&&e(this.map),"object"===i(e)&&(e.current=this.map))}},{key:"render",value:function(){var e=this.props.children;return f.createElement(U.Provider,{value:this.map},e)}}]),a}(s.Component),$=function(e){l(o,e);var i=W(o);function o(){var e;t(this,o);for(var n=arguments.length,l=new Array(n),a=0;a<n;a++)l[a]=arguments[a];return e=i.call.apply(i,[this].concat(l)),r(u(e),"context",null),r(u(e),"parent",new j),e}return n(o,[{key:"componentDidMount",value:function(){_(null!==this.context);var e=this.context.set,t=this.props,n=t.id,r=t.findFiber,i=O(this);_("string"==typeof n),"function"==typeof r?this.parent.setFiber(r(i)):this.parent.setFiber(i),e(n,this.parent)}},{key:"componentWillUnmount",value:function(){_(null!==this.context),(0,this.context.remove)(this.props.id),this.parent.clear()}},{key:"render",value:function(){return this.props.children}}]),o}(s.Component);r($,"Context",U),r($,"Provider",V),r($,"contextType",U),exports.ENV=b,exports.Parent=T,exports.ParentFiber=j,exports.Reparentable=$,exports.ReparentableContext=U,exports.ReparentableMap=z,exports.ReparentableProvider=V,exports.addChildFiberAt=F,exports.addChildFiberBefore=C,exports.addSiblingFiber=k,exports.appendChildFiber=R,exports.config=function(e){Object.assign(b,e)},exports.createParent=function(e,t){var n=new j,r=e.componentDidMount,i=e.componentWillUnmount;return e.componentDidMount=function(){var i=O(e);"function"==typeof t?n.setFiber(t(i)):n.setFiber(i),"function"==typeof r&&r.call(this)},e.componentWillUnmount=function(){"function"==typeof i&&i.call(this),n.clear()},n},exports.findChildFiber=function(e,t){for(var n=e.child;n&&n.key!==t;)n=n.sibling;return n},exports.findChildFiberAt=d,exports.findContainerInstanceFiber=y,exports.findInstanceFiber=m,exports.findPreviousFiber=v,exports.getCurrentFiber=A,exports.getFiberFromClassInstance=O,exports.getFiberFromElementInstance=M,exports.prependChildFiber=w,exports.removeChildFiber=P,exports.removeChildFiberAt=I,exports.removeFirstChildFiber=q,exports.removeSiblingFiber=N,exports.updateFiberDebugOwner=x,exports.updateFibersIndices=g,exports.useParent=function(e){var t=s.useState((function(){return new j})),n=h(t,1)[0],r=s.useRef(null);return s.useEffect((function(){_(null!==r.current);var t=M(r.current);return"function"==typeof e?n.setFiber(e(t)):n.setFiber(t),function(){n.clear()}}),[]),[n,r]},exports.useReparentable=function(){var e=s.useContext(U);return _(null!==e),e};
