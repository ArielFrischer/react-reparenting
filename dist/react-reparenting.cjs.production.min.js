/**
* React-reparenting v0.4.0
* https://paol-imi.github.io/react-reparenting
* Copyright (c) 2020-present, Paol-imi
* Released under the MIT license
* https://github.com/Paol-imi/react-reparenting/blob/master/LICENSE
* @license MIT
*/
"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var n=e(require("@babel/runtime/helpers/classCallCheck")),t=e(require("@babel/runtime/helpers/assertThisInitialized")),r=e(require("@babel/runtime/helpers/inherits")),i=e(require("@babel/runtime/helpers/possibleConstructorReturn")),u=e(require("@babel/runtime/helpers/getPrototypeOf")),l=e(require("@babel/runtime/helpers/wrapNativeSuper")),o=e(require("@babel/runtime/helpers/defineProperty")),a=e(require("@babel/runtime/helpers/createClass")),s=e(require("@babel/runtime/helpers/typeof")),c=require("react"),f={appendChildToContainer:function(e,n){e.appendChild(n)},insertInContainerBefore:function(e,n,t){e.insertBefore(n,t)},removeChildFromContainer:function(e,n){e.removeChild(n)},isElement:function(e,n){return n instanceof Element}};function p(e,n){for(;e;)e.index=n,e=e.sibling,n+=1;return n-1}function d(e,n){var t=e.child;if(null===t)return null;if(-1===n)for(;t.sibling;)t=t.sibling;else for(;t.sibling&&n>0;)n-=1,t=t.sibling;return t}function h(e,n){var t=e.child;if(null===t)return null;if(t.key===n)return e;for(var r=t.sibling;r;){if(r.key===n)return t;r=(t=r).sibling}return null}function b(e,n){for(var t=e.sibling;t&&t.key!==n;)t=t.sibling;return t}function v(e,n,t){if(-1===t)return m(e,n);if(0===t)return F(e,n);var r=d(e,t-1);return null===r?F(e,n):g(r,n)}function y(e,n,t){var r=h(e,t);return null===r?m(e,n):r===e?F(e,n):g(r,n)}function m(e,n){var t=d(e,-1);return null===t?F(e,n):g(t,n)}function g(e,n){var t=e.sibling,r=e.index+1;return e.sibling=n,n.return=e.return,n.sibling=t,r}function F(e,n){var t=e.child;return e.child=n,n.sibling=t,n.return=e,0}function C(e,n,t){for(;e;){if(t(e))return e;e=n(e)}return null}function x(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,r=u(e);if(n){var l=u(this).constructor;t=Reflect.construct(r,arguments,l)}else t=r.apply(this,arguments);return i(this,t)}}var k=function(e){r(u,e);var i=x(u);function u(){var e;n(this,u);for(var r=arguments.length,l=new Array(r),a=0;a<r;a++)l[a]=arguments[a];return e=i.call.apply(i,[this].concat(l)),o(t(e),"name","Invariant"),e}return u}(l(Error));function R(e,n){if(!e)throw new k("Invariant failed")}function N(e,n,t,r){var i;if(R("number"!=typeof t||t>=-1),p(n,i="number"==typeof t?v(e,n,t):y(e,n,t)),null===n.alternate||null===e.alternate?null!==n.alternate&&(n.alternate.return=null,n.alternate.sibling=null):("number"==typeof t?v(e.alternate,n.alternate,t):y(e.alternate,n.alternate,t),p(n.alternate,i)),r)return i;var u=C(e,(function(e){return e.return}),(function(e){return f.isElement(e.elementType,e.stateNode)})),l=C(n,(function(e){return e.child}),(function(e){return f.isElement(e.elementType,e.stateNode)}));if(null===u)return i;if(null===l)return i;var o=u.stateNode,a=l.stateNode;if(null===n.sibling)f.appendChildToContainer(o,a);else{var s=C(n.sibling,(function(e){return e.child}),(function(e){return f.isElement(e.elementType,e.stateNode)}));if(null!==s){var c=s.stateNode;f.insertInContainerBefore(o,a,c)}}return i}function w(e,n){if(0===n)return I(e);var t=d(e,n-1);return null===t?null:E(t)}function D(e,n){var t=h(e,n);return null===t?null:t===e?I(e):E(t)}function I(e){var n=e.child;return null===n?null:(e.child=n.sibling,n)}function E(e){var n=e.sibling;return null===n?null:(e.sibling=n.sibling,n)}function P(e,n,t){R("number"!=typeof n||n>=0);var r=null;if(null===(r="number"==typeof n?w(e,n):D(e,n)))return null;if(null!==r.sibling&&p(r.sibling,r.index),null!==r.alternate&&null!==e.alternate){var i=null;R(null!==(i="number"==typeof n?w(e.alternate,n):D(e.alternate,n))),null!==i.sibling&&p(i.sibling,i.index)}if(t)return r;var u=C(e,(function(e){return e.return}),(function(e){return f.isElement(e.elementType,e.stateNode)})),l=C(r,(function(e){return e.child}),(function(e){return f.isElement(e.elementType,e.stateNode)}));if(null===u)return r;if(null===l)return r;var o=u.stateNode,a=l.stateNode;return f.removeChildFromContainer(o,a),r}function q(e){if(null===e.alternate)return e;for(var n=e;null!==n.return;)n=n.return;return R(null!==n.stateNode&&"current"in n.stateNode),n.stateNode.current===n?e:e.alternate}function _(e){var n=Object.keys(e).find((function(e){return e.startsWith("__reactInternalInstance$")}));return R("string"==typeof n),e[n]}function S(e){return R("_reactInternalFiber"in e),e._reactInternalFiber}var T=function(){function e(){n(this,e),o(this,"fiber",null),o(this,"findFiber",void 0)}return a(e,[{key:"setFiber",value:function(e){this.fiber=e}},{key:"setFinder",value:function(e){this.findFiber=e}},{key:"getCurrent",value:function(){R(null!==this.fiber);var e=q(this.fiber);return"function"==typeof this.findFiber?this.findFiber(e):e}},{key:"addChild",value:function(e,n,t){return N(this.getCurrent(),e,n,t)}},{key:"removeChild",value:function(e,n){return P(this.getCurrent(),e,n)}},{key:"sendChild",value:function(e,n,t,r){var i=this.removeChild(n,r);return null===i?-1:e.addChild(i,t,r)}},{key:"clear",value:function(){this.fiber=null}}]),e}();function M(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,r=u(e);if(n){var l=u(this).constructor;t=Reflect.construct(r,arguments,l)}else t=r.apply(this,arguments);return i(this,t)}}var j=function(e){r(u,e);var i=M(u);function u(){var e;n(this,u);for(var r=arguments.length,l=new Array(r),a=0;a<r;a++)l[a]=arguments[a];return e=i.call.apply(i,[this].concat(l)),o(t(e),"parent",new T),e}return a(u,[{key:"componentDidMount",value:function(){var e=this.props,n=e.parentRef,t=e.findFiber,r=S(this);R(null!==n&&("function"==typeof n||"object"===s(n))),this.parent.setFiber(r),this.parent.setFinder(t),"function"==typeof n&&n(this.parent),"object"===s(n)&&null!==n&&(n.current=this.parent)}},{key:"componentDidUpdate",value:function(){var e=this.props.findFiber;this.parent.setFinder(e)}},{key:"componentWillUnmount",value:function(){this.parent.clear()}},{key:"render",value:function(){return this.props.children}}]),u}(c.Component);function A(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,r=u(e);if(n){var l=u(this).constructor;t=Reflect.construct(r,arguments,l)}else t=r.apply(this,arguments);return i(this,t)}}var O=new Map;var U=function(e){r(u,e);var i=A(u);function u(){var e;n(this,u);for(var r=arguments.length,l=new Array(r),a=0;a<r;a++)l[a]=arguments[a];return e=i.call.apply(i,[this].concat(l)),o(t(e),"parent",new T),e}return a(u,[{key:"componentDidMount",value:function(){var e=this.props,n=e.id,t=e.findFiber,r=S(this);R("string"==typeof n),this.parent.setFiber(r),this.parent.setFinder(t),O.set(n,this.parent)}},{key:"componentDidUpdate",value:function(){var e=this.props.findFiber;this.parent.setFinder(e)}},{key:"componentWillUnmount",value:function(){var e=this.props.id;O.delete(e),this.parent.clear()}},{key:"render",value:function(){return this.props.children}}]),u}(c.Component);exports.Env=f,exports.Parent=j,exports.ParentFiber=T,exports.Reparentable=U,exports.ReparentableMap=O,exports.addChild=N,exports.addChildFiberAt=v,exports.addChildFiberBefore=y,exports.addSiblingFiber=g,exports.appendChildFiber=m,exports.configure=function(e){Object.assign(f,e)},exports.createParent=function(e,n){var t=new T,r=e.componentDidMount,i=e.componentWillUnmount;return e.componentDidMount=function(){var i=S(e);t.setFiber(i),t.setFinder(n),"function"==typeof r&&r.call(this)},e.componentWillUnmount=function(){"function"==typeof i&&i.call(this),t.clear()},t},exports.findChildFiber=function(e,n){var t=e.child;return null===t?null:t.key===n?t:b(t,n)},exports.findChildFiberAt=d,exports.findPreviousFiber=h,exports.findSiblingFiber=b,exports.getCurrentFiber=q,exports.getFiberFromClassInstance=S,exports.getFiberFromElementInstance=_,exports.prependChildFiber=F,exports.removeChild=P,exports.removeChildFiber=D,exports.removeChildFiberAt=w,exports.removeFirstChildFiber=I,exports.removeSiblingFiber=E,exports.searchFiber=C,exports.sendReparentableChild=function(e,n,t,r,i){var u=O.get(e),l=O.get(n);return void 0===u||void 0===l?-1:u.sendChild(l,t,r,i)},exports.updateFiberDebugFields=function(e,n){var t;t=n.child===e?null===e.sibling?n:e.sibling:n.child||n,e._debugOwner=t._debugOwner,e._debugSource=t._debugSource},exports.updateFibersIndex=p,exports.useParent=function(e,n){var t=c.useRef(null);null===t.current&&(t.current=new T);var r=t.current;return r.setFinder(n),c.useEffect((function(){return R(null!==e.current&&void 0!==e.current),r.setFiber(_(e.current)),function(){r.clear()}}),[]),r};
