/**
* React-reparenting v0.2.0
* https://paol-imi.github.io/react-reparenting
* Copyright (c) 2020-present, Paol-imi
* Released under the MIT license
* https://github.com/Paol-imi/react-reparenting/blob/master/LICENSE
* @license MIT
*/
"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("@babel/runtime/helpers/classCallCheck")),n=e(require("@babel/runtime/helpers/createClass")),r=e(require("@babel/runtime/helpers/defineProperty")),i=e(require("@babel/runtime/helpers/typeof")),u=e(require("@babel/runtime/helpers/assertThisInitialized")),l=e(require("@babel/runtime/helpers/inherits")),o=e(require("@babel/runtime/helpers/possibleConstructorReturn")),a=e(require("@babel/runtime/helpers/getPrototypeOf")),c=e(require("@babel/runtime/helpers/wrapNativeSuper")),s=require("react"),f=e(s),p=e(require("@babel/runtime/helpers/get")),h={appendChildToContainer:function(e,t){e.appendChild(t)},insertInContainerBefore:function(e,t,n){e.insertBefore(t,n)},removeChildFromContainer:function(e,t){e.removeChild(t)},isElement:function(e,t){return t instanceof Element}};function d(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var b=function(e){l(c,e);var n,i=(n=c,function(){var e,t=a(n);if(d()){var r=a(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return o(this,e)});function c(){var e;t(this,c);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return e=i.call.apply(i,[this].concat(l)),r(u(e),"name","Invariant"),e}return c}(c(Error));function v(e,t){if(!e)throw new b("Invariant failed")}function y(e){if(!e.alternate)return e;for(var t=e;t.return;)t=t.return;return v(null!==t.stateNode&&"current"in t.stateNode),t.stateNode.current===t?e:e.alternate}function m(e){var t=Object.keys(e).find((function(e){return e.startsWith("__reactInternalInstance$")}));return v("string"==typeof t),e[t]}function g(e){return v("object"===i(e)&&"_reactInternalFiber"in e),e._reactInternalFiber}function x(e,t){v(t>=-1);var n=e.child;if(null===n)return null;if(-1===t)for(var r=n.sibling;r;)r=(n=r).sibling;else for(var i=n.sibling;i&&t>0;)t-=1,i=(n=i).sibling;return n}function C(e,t){var n=e.child;if(null===n)return null;if(n.key===t)return e;for(var r=n.sibling;r;){if(r.key===t)return n;r=(n=r).sibling}return null}function F(e,t){for(;e;){if(t(e.elementType,e.stateNode))return e;e=e.return}return null}function R(e,t){for(;e;){if(t(e.elementType,e.stateNode))return e;e=e.child}return null}function k(e,t,n){if(-1===n)return N(e,t);if(0===n)return P(e,t);var r=x(e,n-1);return null===r?N(e,t):I(r,t)}function w(e,t,n){var r=C(e,n);return null===r?N(e,t):r===e?P(e,t):I(r,t)}function N(e,t){var n=x(e,-1);return null===n?P(e,t):I(n,t)}function I(e,t){var n=e.sibling,r=e.index+1;return e.sibling=t,t.sibling=n,t.return=e.return,r}function P(e,t){var n=e.child;return e.child=t,t.sibling=n,t.return=e,0}function D(e,t){if(v(t>=0),0===t)return _(e);var n=x(e,t-1);return null===n?null:E(n)}function q(e,t){var n=C(e,t);return null===n?null:n===e?_(e):E(n)}function E(e){var t=e.sibling;return null===t?null:(e.sibling=t.sibling,t)}function _(e){var t=e.child;return null===t?null:(e.child=t.sibling,t)}function M(e,t){for(;e;)e.index=t,e=e.sibling,t+=1;return t-1}var j=function(){function e(n){t(this,e),r(this,"fiber",null),n&&this.set(n)}return n(e,[{key:"set",value:function(e){this.fiber=e}},{key:"getCurrent",value:function(){return v(null!==this.fiber),y(this.fiber)}},{key:"add",value:function(e,t){var n,r=this.getCurrent();return M(e,n="number"==typeof t?k(r,e,t):w(r,e,t)),null===e.alternate||null===r.alternate?(e.alternate=null,n):("number"==typeof t?k(r.alternate,e.alternate,t):w(r.alternate,e.alternate,t),M(e.alternate,n),n)}},{key:"remove",value:function(e){var t=this.getCurrent(),n=null;if(null===(n="number"==typeof e?D(t,e):q(t,e)))return null;if(null!==n.sibling&&M(n.sibling,n.index),null===n.alternate||null===t.alternate)return n;var r=null;return v(null!==(r="number"==typeof e?D(t.alternate,e):q(t.alternate,e))),null!==r.sibling&&M(r.sibling,r.index),n}},{key:"send",value:function(e,t,n,r){var i=this.remove(e);if(null===i)return-1;var u=t.add(i,n);if(r)return u;var l=F(this.fiber,h.isElement),o=F(t.fiber,h.isElement);if(null===l||null===o)return u;var a=R(i,h.isElement);if(null===a)return u;if(h.removeChildFromContainer(l.stateNode,a.stateNode),null===i.sibling)h.appendChildToContainer(o.stateNode,a.stateNode);else{var c=R(i.sibling,h.isElement);if(null===c)return u;h.insertInContainerBefore(o.stateNode,a.stateNode,c.stateNode)}return u}},{key:"clear",value:function(){this.fiber=null}}]),e}();function A(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var S=function(e){l(f,e);var c,s=(c=f,function(){var e,t=a(c);if(A()){var n=a(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return o(this,e)});function f(){var e;t(this,f);for(var n=arguments.length,i=new Array(n),l=0;l<n;l++)i[l]=arguments[l];return e=s.call.apply(s,[this].concat(i)),r(u(e),"parent",new j),e}return n(f,[{key:"componentDidMount",value:function(){var e=this.props,t=e.parentRef,n=e.findFiber,r=g(this);v(null!==t&&("function"==typeof t||"object"===i(t))),"function"==typeof n?this.parent.set(n(r)):this.parent.set(r),"function"==typeof t&&t(this.parent),"object"===i(t)&&null!==t&&(t.current=this.parent)}},{key:"componentWillUnmount",value:function(){this.parent.clear()}},{key:"render",value:function(){return this.props.children}}]),f}(s.Component);function O(e){return function(){var t,n=a(e);if(T()){var r=a(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return o(this,t)}}function T(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var W=s.createContext(null);W.displayName="Reparentable";var B=function(e){l(i,e);var n=O(i);function i(){var e;t(this,i);for(var l=arguments.length,o=new Array(l),c=0;c<l;c++)o[c]=arguments[c];return e=n.call.apply(n,[this].concat(o)),r(u(e),"set",(function(t,n){return p(a(i.prototype),"set",u(e)).call(u(e),t,n)})),r(u(e),"send",(function(t,n,r,i,u){var l=e.get(t),o=e.get(n);return void 0===l||void 0===o?-1:l.send(r,o,i,u)})),r(u(e),"remove",(function(t){return e.delete(t)})),e}return i}(c(Map)),U=function(e){l(a,e);var o=O(a);function a(){var e;t(this,a);for(var n=arguments.length,i=new Array(n),l=0;l<n;l++)i[l]=arguments[l];return e=o.call.apply(o,[this].concat(i)),r(u(e),"map",new B),e}return n(a,[{key:"componentDidMount",value:function(){var e=this.props.reparentableMapRef;"function"==typeof e&&e(this.map),"object"===i(e)&&null!==e&&(e.current=this.map)}},{key:"render",value:function(){var e=this.props.children;return f.createElement(W.Provider,{value:this.map},e)}}]),a}(s.Component),z=function(e){l(o,e);var i=O(o);function o(){var e;t(this,o);for(var n=arguments.length,l=new Array(n),a=0;a<n;a++)l[a]=arguments[a];return e=i.call.apply(i,[this].concat(l)),r(u(e),"context",null),r(u(e),"parent",new j),e}return n(o,[{key:"componentDidMount",value:function(){v(null!==this.context);var e=this.context.set,t=this.props,n=t.id,r=t.findFiber,i=g(this);v("string"==typeof n),"function"==typeof r?this.parent.set(r(i)):this.parent.set(i),e(n,this.parent)}},{key:"componentWillUnmount",value:function(){v(null!==this.context),(0,this.context.remove)(this.props.id),this.parent.clear()}},{key:"render",value:function(){return this.props.children}}]),o}(s.Component);r(z,"Context",W),r(z,"Provider",U),r(z,"contextType",W);exports.ENV=h,exports.Parent=S,exports.ParentFiber=j,exports.Reparentable=z,exports.ReparentableContext=W,exports.ReparentableMap=B,exports.ReparentableProvider=U,exports.addChildFiberAt=k,exports.addChildFiberBefore=w,exports.addSiblingFiber=I,exports.appendChildFiber=N,exports.configure=function(e){Object.assign(h,e)},exports.createParent=function(e,t){var n=new j,r=e.componentDidMount,i=e.componentWillUnmount;return e.componentDidMount=function(){var i=g(e);"function"==typeof t?n.set(t(i)):n.set(i),"function"==typeof r&&r.call(this)},e.componentWillUnmount=function(){"function"==typeof i&&i.call(this),n.clear()},n},exports.findChildFiber=function(e,t){for(var n=e.child;n&&n.key!==t;)n=n.sibling;return n},exports.findChildFiberAt=x,exports.findContainerInstanceFiber=F,exports.findInstanceFiber=R,exports.findPreviousFiber=C,exports.getCurrentFiber=y,exports.getFiberFromClassInstance=g,exports.getFiberFromElementInstance=m,exports.prependChildFiber=P,exports.removeChildFiber=q,exports.removeChildFiberAt=D,exports.removeFirstChildFiber=_,exports.removeSiblingFiber=E,exports.updateFiberDebugFields=function(e,t){var n;n=t.child===e&&null!==e.sibling?e.sibling:null!==t.child?t.child:t,e._debugOwner=n._debugOwner,e._debugSource=n._debugSource},exports.updateFibersIndices=M,exports.useParent=function(e){var t=s.useRef(null),n=s.useRef(null);null===t.current&&(t.current=new j);var r=t.current;return s.useEffect((function(){v(null!==n.current);var t=m(n.current);return"function"==typeof e?r.set(e(t)):r.set(t),function(){r.clear()}}),[]),[r,n]},exports.useReparentable=function(){var e=s.useContext(W);return v(null!==e),e};
